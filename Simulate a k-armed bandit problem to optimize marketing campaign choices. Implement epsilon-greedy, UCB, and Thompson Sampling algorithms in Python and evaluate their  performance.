import random, math
prob = [0.2, 0.4, 0.3]
k = 3
T = 300

def pull(i):
    return 1 if random.random() < prob[i] else 0

def eps_greedy(eps=0.1):
    Q = [0]*k
    N = [0]*k
    reward = 0
    for _ in range(T):
        i = random.randint(0,k-1) if random.random() < eps else Q.index(max(Q))
        r = pull(i)
        N[i] += 1
        Q[i] += (r - Q[i]) / N[i]
        reward += r
    return reward
def ucb():
    Q = [0]*k
    N = [1]*k
    reward = 0
    for t in range(1, T+1):
        u = [Q[i] + math.sqrt(2*math.log(t)/N[i]) for i in range(k)]
        i = u.index(max(u))
        r = pull(i)
        N[i] += 1
        Q[i] += (r - Q[i]) / N[i]
        reward += r
    return reward
def thompson():
    a = [1]*k
    b = [1]*k
    reward = 0
    for _ in range(T):
        s = [random.betavariate(a[i], b[i]) for i in range(k)]
        i = s.index(max(s))
        r = pull(i)
        a[i] += r
        b[i] += 1 - r
        reward += r
    return reward

print("Epsilon-Greedy Reward:", eps_greedy())
print("UCB Reward:", ucb())
print("Thompson Sampling Reward:", thompson())
